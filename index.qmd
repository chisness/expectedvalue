---
title: "The Expected Value Foundation"
execute:
  echo: false
format: html
resources: 
    - CNAME
---
## Welcome! 
We believe that expected value is one of the most important concepts for making better decisions in an uncertain world. Understanding expected value helps us think more clearly about risks, rewards, and tradeoffs.

Nate Silver in *On the Edge*: 

> Society would be generally better off--I'll confidently contend--if people understood the nature of expected value and specifically the importance of low-probability, high-impact events, whether they come in the form of fantastic potential payoffs or catastrophic risks.

## What is expected value?
Expected value (EV) is the average of all possible outcomes. It's computed by adding each possible outcome weighted by its probability of occurring: 

$\text{Expected Value} =  \text{(Probability of each outcome)} \cdot \text{(Value of each outcome)}$

In math terms:

$\mathbb{E}[X] = \sum\limits_{i} P(X=x_i) \cdot x_i$

### Drawing a card
Here's a simple card game where you get to draw 1 card and get the prize indicated on that card.

![](card-game.svg){fig-alt="A visualization showing four playing cards displaying numbers 1, 1, 2, and 3, each with a 1/4 chance of being drawn"}

Each card is equally likely to be selected with probability $P=1/4$. Note that the probabilities (weights) always sum to 1 because they describe all possible outcomes. 

Let's compute the EV: 

$$
\begin{align*}
\mathbb{E}[\text{Draw Card}] &= \frac{1}{4}(1) + \frac{1}{4}(1) + \frac{1}{4}(2) + \frac{1}{4}(3) \\
&= \frac{1}{4} + \frac{1}{4} + \frac{2}{4} + \frac{3}{4} \\
&= \frac{7}{4} \\
&= 1.75
\end{align*}
$$

Therefore the expected value, or average outcome, when drawing a card is **1.75**. 

Note that EV is not a possible outcome (we couldn't actually draw 1.75), but rather summarizes the set of possible outcomes. 

```{ojs}
//| echo: false
import {Inputs} from "@observablehq/inputs"
import {Plot} from "@observablehq/plot"

// Define distinct cards
cards = [
  {value: 1, id: "1a"},
  {value: 1, id: "1b"},
  {value: 2, id: "2"},
  {value: 3, id: "3"}
]

// Expected value
expectedValue = 1.75

// Create individual buttons
viewof drawOne = Inputs.button("Draw 1 Card", {
  style: `
    background: #1a1a1a;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
  `
})

viewof drawTen = Inputs.button("Draw 10 Cards", {
  style: `
    background: #1a1a1a;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
  `
})

viewof drawHundred = Inputs.button("Draw 100 Cards", {
  style: `
    background: #1a1a1a;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
  `
})

// Button container
buttonsContainer = html`
<div style="display: flex; gap: 10px; align-items: center; margin-bottom: 20px;">
  ${viewof drawOne}
  ${viewof drawTen}
  ${viewof drawHundred}
</div>
`

// State management for drawn cards
values = {
  let currentValues = window._cardValues || [];
  
  // Track previous button states to detect changes
  const prevStates = window._prevButtonStates || {
    drawOne: drawOne,
    drawTen: drawTen,
    drawHundred: drawHundred
  };
  
  // Detect which button was clicked by comparing with previous state
  let action = null;
  if (drawOne !== prevStates.drawOne) {
    action = "drawOne";
  } else if (drawTen !== prevStates.drawTen) {
    action = "drawTen";
  } else if (drawHundred !== prevStates.drawHundred) {
    action = "drawHundred";
  }
  
  // Update previous states
  window._prevButtonStates = {
    drawOne,
    drawTen,
    drawHundred
  };
  
  // Handle drawing based on action
  if (action === "drawOne") {
    currentValues.push(cards[Math.floor(Math.random() * cards.length)]);
  } else if (action === "drawTen") {
    for (let i = 0; i < 10; i++) {
      currentValues.push(cards[Math.floor(Math.random() * cards.length)]);
    }
  } else if (action === "drawHundred") {
    for (let i = 0; i < 100; i++) {
      currentValues.push(cards[Math.floor(Math.random() * cards.length)]);
    }
  }
  
  window._cardValues = currentValues;
  return currentValues;
}

// Calculate running averages
runningAverages = values.map((_, i) => ({
  x: i + 1,
  y: values.slice(0, i + 1).reduce((a, b) => a + b.value, 0) / (i + 1)
}))

// Compute counts for each card type
cardCounts = values.reduce((acc, card) => {
  acc[card.id] = (acc[card.id] || 0) + 1;
  return acc;
}, {})

// Stats
totalDraws = values.length
currentAverage = runningAverages.length > 0 ? 
  runningAverages[runningAverages.length - 1].y.toFixed(3) : 
  "N/A"

// Helper functions for display
percent = (id) => {
  if (totalDraws === 0) return "0%";
  const p = (cardCounts[id] || 0) / totalDraws * 100;
  return p.toFixed(1) + "%";
}

count = (id) => cardCounts[id] || 0

// Card display SVG
smallCardsSVG = html`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 160 80" style="width: 100%; height: auto;">
  <defs>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="1"/>
      <feOffset dx="1" dy="1" result="offsetblur"/>
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.3"/>
      </feComponentTransfer>
      <feMerge>
        <feMergeNode/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <linearGradient id="cardGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#f8f9fa;stop-opacity:1"/>
    </linearGradient>
  </defs>
  
  <!-- Cards -->
  <g transform="translate(10,12)">
    <!-- Card 1a -->
    <g transform="translate(0,0)" filter="url(#shadow)">
      <text x="14" y="-3" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">P = 1/4</text>
      <rect width="28" height="42" rx="4" fill="url(#cardGradient)" stroke="#2196f3" stroke-width="1"/>
      <text x="14" y="26" font-family="system-ui, -apple-system" font-weight="bold" font-size="14" text-anchor="middle" fill="#e74c3c">1</text>
      <text x="14" y="54" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">Count: ${count("1a")}</text>
      <text x="14" y="62" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">${percent("1a")}</text>
    </g>
    
    <!-- Card 1b -->
    <g transform="translate(38,0)" filter="url(#shadow)">
      <text x="14" y="-3" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">P = 1/4</text>
      <rect width="28" height="42" rx="4" fill="url(#cardGradient)" stroke="#2196f3" stroke-width="1"/>
      <text x="14" y="26" font-family="system-ui, -apple-system" font-weight="bold" font-size="14" text-anchor="middle" fill="#e74c3c">1</text>
      <text x="14" y="54" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">Count: ${count("1b")}</text>
      <text x="14" y="62" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">${percent("1b")}</text>
    </g>
    
    <!-- Card 2 -->
    <g transform="translate(76,0)" filter="url(#shadow)">
      <text x="14" y="-3" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">P = 1/4</text>
      <rect width="28" height="42" rx="4" fill="url(#cardGradient)" stroke="#2196f3" stroke-width="1"/>
      <text x="14" y="26" font-family="system-ui, -apple-system" font-weight="bold" font-size="14" text-anchor="middle" fill="#e74c3c">2</text>
      <text x="14" y="54" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">Count: ${count("2")}</text>
      <text x="14" y="62" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">${percent("2")}</text>
    </g>
    
    <!-- Card 3 -->
    <g transform="translate(114,0)" filter="url(#shadow)">
      <text x="14" y="-3" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">P = 1/4</text>
      <rect width="28" height="42" rx="4" fill="url(#cardGradient)" stroke="#2196f3" stroke-width="1"/>
      <text x="14" y="26" font-family="system-ui, -apple-system" font-weight="bold" font-size="14" text-anchor="middle" fill="#e74c3c">3</text>
      <text x="14" y="54" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">Count: ${count("3")}</text>
      <text x="14" y="62" font-family="system-ui, -apple-system" font-size="6" text-anchor="middle" fill="#666666">${percent("3")}</text>
    </g>
  </g>
</svg>
`

// Chart container
chartContainer = {
  const chart = Plot.plot({
    width: 800,
    height: 400,
    margin: 50,
    grid: true,
    style: {
      fontSize: 12,
      fontFamily: "system-ui, -apple-system"
    },
    y: {
      domain: [0, 4],
      label: "↑ Running Average",
      grid: true
    },
    x: {
      label: "Number of Draws →",
      grid: true
    },
    marks: [
      Plot.line(runningAverages, {
        x: "x", 
        y: "y", 
        stroke: "#2196f3",
        strokeWidth: 1.5
      }),
      Plot.ruleY([expectedValue], {
        stroke: "red", 
        strokeDasharray: "5,5",
        strokeOpacity: 0.5
      }),
      Plot.text([{x: runningAverages.length, y: expectedValue}], {
        text: ["Expected Value (1.75)"],
        dx: 10,
        fill: "red",
        fontSize: 10
      })
    ]
  });
  
  const container = html`<div>
    <div style="margin-bottom: 1rem; display: flex; flex-direction: row; align-items: center; justify-content: center; gap: 0.75rem;">
      ${html`<div style="
        background: rgba(255,255,255,0.95); 
        padding: 0.5rem 0.75rem; 
        border-radius: 6px; 
        font-size: 12px; 
        font-family: system-ui, -apple-system;
        border: 1px solid #e0e0e0;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      ">
        <div style="margin-bottom: 0.25rem"><strong>Total draws:</strong> ${totalDraws}</div>
        <div><strong>Current average:</strong> ${currentAverage}</div>
      </div>`}
      ${html`<div style="
        background: rgba(255,255,255,0.95); 
        padding: 0.75rem; 
        border-radius: 6px; 
        font-size: 12px;
        font-family: system-ui, -apple-system;
        border: 1px solid #e0e0e0;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        max-width: 140px;
        width: 100%;
      ">
        ${smallCardsSVG}
      </div>`}
    </div>
    ${chart}
  </div>`;
  
  return container;
}

// Display everything
html`
${buttonsContainer}
${chartContainer}
`
```

### Buying ice cream

**Suppose that you are buying an ice cream:**

The store is selling an ice cream cone for **$7**. 

They also have a special offer: 

- Flip a coin
- If the coin is **heads**, you buy the ice cream for **$10**
- If the coin is **tails**, you get the ice cream for **free**

interactive

**What is the expected value of the coin flip?**

1. What is the probability of each outcome? Heads and tails are both 50% likely. 

2. What is the value of each outcome? The cost for heads is $10 and the cost for tails is $0. 

3. The expected value of the coin flip is as follows, where $P$ represents probability and $V$ represents value.

$$
\begin{aligned}
\text{EV} &= P(\text{Heads}) \cdot V(\text{Heads}) + P(\text{Tails}) \cdot V(\text{Tails}) \\
   &= (0.5) \cdot (\$10) + (0.5) \cdot (\$0) \\
   &= \$5
\end{aligned}
$$

This means that the *expected value* of the coin flip is **$5**, a better deal than the standard price of **$7**. 

The EV calculation helps make decisions by providing a framework to evaluate options with uncertain outcomes. In most cases, the better expected value means that that is the better decision, and we should therefore **take the coin flip option**. 

But not always. There are other considerations like risk tolerance (some prefer a guaranteed price of $7 to chancing a price of $10), resource constraints ($10 could be a large strain on the budget), and others. 

## What we do
- [EV Tutorial (this website)](tutorial/): Learn about expected value through our tutorial and interactive examples
- [EV Workshops](workshops/): In-person workshops on expected value
- [EV Day](evday2025/): A day of EV-centric and adjacent workshops, along with a charity poker tournament
- [Poker Camp](https://poker.camp): Workshops and courses on AI and applied rationality through the lens of poker
- [EV Fellowship](fellowship.qmd): Contribute your strengths to the EVF in areas like research, coding, writing, logistics, running workshops, and creating videos

![EV workshop at Ecole les Hirondelles Mermoz in Dakar, Senegal (December, 2024)](assets/dakar1.jpg)